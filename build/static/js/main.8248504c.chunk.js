(this.webpackJsonpnfteam=this.webpackJsonpnfteam||[]).push([[0],{105:function(e,t){},106:function(e,t){},109:function(e,t){},113:function(e,t){},114:function(e,t){},115:function(e,t){},235:function(e,t,a){"use strict";a.r(t);a(98);var s=a(1),r=a.n(s),n=a(56),c=a.n(n),i=a(8),o=a(10),l=a(2),u=a(12),d=a(42),j=a(3),b=a(4),h=a(5),m=a(6),p=a(0),f=["label","handleClick","disabled"],O=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(j.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={circles:[],circleCount:0,timers:[]},e.circleEffect=function(t){t.preventDefault();var a=t.clientX-t.target.offsetLeft,s=t.clientY-t.target.offsetTop,r=e.state.circles,n=e.state.circleCount+1;r.push({x:a,y:s,circleCount:n}),e.setState({circles:r,circleCount:n});var c=setTimeout((function(){r=e.state.circles;var t=0;r=r.filter((function(e){return e.x!=a||e.y!=s||t>0||(t++,!1)})),e.setState({circles:r}),clearTimeout(c)}),1e3);e.state.timers.push(c),e.setState({timer:c})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.state.timers.forEach((function(e){clearTimeout(e)}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.label,s=t.handleClick,r=t.disabled,n=Object(d.a)(t,f);return Object(p.jsxs)("button",Object(u.a)(Object(u.a)({disabled:r},n),{},{onClick:function(t){t.preventDefault(),e.circleEffect(t),s(t)},children:[a,this.state.circles&&this.state.circles.map((function(e){return Object(p.jsx)("span",{style:{left:e.x+"px",top:e.y+"px"},children:"3"},e.circleCount)}))]}))}}]),a}(r.a.Component),v=O,x=Object(s.createContext)(),g=a(94),y=a(9),w=a.n(y),C=["label","onChange","value","className"],S=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(j.a)(this,a),t.apply(this,arguments)}return Object(b.a)(a,[{key:"render",value:function(){var e=this.props,t=e.label,a=e.onChange,s=e.value,r=e.className,n=Object(d.a)(e,C);return Object(p.jsxs)("div",{className:"input-group",children:[Object(p.jsx)("input",Object(u.a)({autoComplete:"off",placeholder:" ",onChange:a,value:s,type:"text",name:t,id:t,"aria-label":t,className:r||""},n)),Object(p.jsx)("label",{htmlFor:t,children:t})]})}}]),a}(r.a.Component),E=S,k=w.a.query,A=(k.Documents,k.Map,k.Ref,k.ContainsStr),_=k.LowerCase,q=k.Or,N=k.Filter,U=k.Paginate,D=k.Get,L=k.Match,I=k.CurrentIdentity,P=k.Select,M=k.Index,T=(k.Create,k.Lambda),R=(k.Collection,k.Join,k.Call,k.Var),F=(k.Function,function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(j.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={username:"",picture:"",searchValue:"",searchResults:[]},e.handleSearch=function(t){var a=e.context,s=a.user,r=(a.setUser,t.target.value);(e.setState({searchValue:r}),s&&r)&&new w.a.Client({secret:s,domain:"db.eu.fauna.com",scheme:"https"}).query(N(U(L(M("users_and_names"))),T(["username","picture","ref"],q(A(R("username"),r),A(_(R("username")),_(r)))))).then((function(t){console.log(t);var a=t.data;e.setState({searchResults:a})})).catch((function(e){console.error(e)}))},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.context,a=t.user,s=t.setUser;if(a){new w.a.Client({secret:a,domain:"db.eu.fauna.com",scheme:"https"}).query(P(["data"],D(I()))).then((function(t){e.setState({username:t.username}),e.setState({picture:t.picture})}))}else{var r=localStorage.getItem("user");if(r){var n=r;s(n),new w.a.Client({secret:n,domain:"db.eu.fauna.com",scheme:"https"}).query(P(["data"],D(I()))).then((function(t){e.setState({username:t.username}),e.setState({picture:t.picture})}))}}}},{key:"render",value:function(){var e=this.context,t=e.user;e.setUser;return Object(g.a)(this.props),t?Object(p.jsxs)("div",{className:"navbar",children:[Object(p.jsx)(o.c,{className:"nav-link",to:"/home",children:"Home"}),Object(p.jsx)(o.c,{className:"nav-link",to:"/create",children:"Create"}),Object(p.jsxs)("div",{className:"search-container "+(this.state.searchValue?"":"empty"),children:[Object(p.jsx)("input",{type:"text",placeholder:"Search For User",value:this.state.searchValue,onChange:this.handleSearch}),Object(p.jsx)("ul",{className:"",children:this.state.searchResults.length?this.state.searchResults.map((function(e,t){return Object(p.jsx)("li",{children:Object(p.jsx)("a",{href:"/profile/"+e[2].value.id,children:e[0]})},t)})):Object(p.jsx)("li",{children:"No search results found"})})]}),Object(p.jsxs)(o.c,{className:"nav-link right nav-profile",to:"/profile",children:[this.state.username?Object(p.jsx)("span",{children:this.state.username}):"",this.state.picture?Object(p.jsx)("img",{src:this.state.picture,alt:""}):""]}),Object(p.jsx)(o.c,{className:"nav-link right",to:"/logout",children:"Logout"})]}):Object(p.jsxs)("div",{className:"navbar",children:[Object(p.jsx)(o.c,{className:"nav-link",to:"/home",children:"Home"}),Object(p.jsx)(o.c,{className:"nav-link right",to:"/login",children:"Login"}),Object(p.jsx)(o.c,{className:"nav-link right",to:"/register",children:"Register"})]})}}]),a}(r.a.Component));F.contextType=x;var Z=F,B=w.a.query;B.Documents,B.Map,B.Ref,B.Paginate,B.Get,B.Match,B.Select,B.Index,B.Create,B.Lambda,B.Collection,B.Join,B.Call,B.Function;var J=function(){var e=Object(s.useContext)(x),t=e.user,a=e.setUser;return Object(s.useEffect)((function(){if(!t){var e=localStorage.getItem("user");if(e)a(e)}}),[]),Object(p.jsx)("div",{className:"App",children:t?Object(p.jsxs)("div",{children:["You are signed with key: ",t]}):Object(p.jsx)("div",{children:"You aren't logged in!"})})},H=(a(66),a(14)),V=w.a.query,z=(V.Documents,V.Map,V.Ref,V.Paginate,V.Get,V.Exists,V.Match),G=(V.Select,V.Index),W=(V.Create,V.Lambda,V.Collection,V.Join,V.Login),$=(V.Call,V.Function,function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(j.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{username:"",password:""},loginFailed:"",redir:!1},e.updateUsername=function(t){var a=Object(u.a)({},e.state.data),s=t.target.value;a.username=s,e.setState({data:a})},e.updatePassword=function(t){var a=Object(u.a)({},e.state.data),s=t.target.value;a.password=s,e.setState({data:a})},e.formSubmit=function(t){console.log(e.context),t.preventDefault(),console.log("Trying to log in");var a=e.state.data,s=a.username,r=a.password,n=new w.a.Client({secret:"fnAEaWbgzoAAwyZTDq94vnfSjZm27pfo9meEZH29",domain:"db.eu.fauna.com",scheme:"https"}),c="";-1==s.indexOf("@")?(console.log("Logging in using USERNAME"),c=W(z(G("users_by_username"),s),{password:r})):(console.log("Logging in using EMAIL"),c=W(z(G("users_by_email"),s),{password:r})),n.query(c).then((function(t){console.log(t);var a=e.context;a.user;(0,a.setUser)(t.secret),localStorage.setItem("user",t.secret),e.setState({redir:!0})})).catch((function(t){e.setState({loginFailed:"Invalid Login"}),console.log(t)}))},e}return Object(b.a)(a,[{key:"render",value:function(){var e=this.context.user;return Object(p.jsx)(p.Fragment,{children:this.state.redir?Object(p.jsx)(l.a,{to:"/",replace:!0}):Object(p.jsxs)("div",{id:"login_account",children:[Object(p.jsxs)("h1",{children:["Login To An Account! ",e]}),Object(p.jsx)("div",{className:"form-container",children:Object(p.jsxs)("form",{children:[this.state.loginFailed&&Object(p.jsx)("div",{className:"field-validation-error",role:"alert",children:this.state.loginFailed}),Object(p.jsx)("br",{}),Object(p.jsx)(E,{value:this.state.data.username,label:"Username",onChange:this.updateUsername}),Object(p.jsx)("br",{}),Object(p.jsx)(E,{type:"password",value:this.state.data.password,label:"Password",onChange:this.updatePassword}),Object(p.jsx)("br",{}),Object(p.jsx)(v,{disabled:this.state.data.disabled,label:"Login",handleClick:this.formSubmit}),Object(p.jsx)("br",{}),Object(p.jsx)(o.b,{to:"/register",children:"Register"})]})})]})})}}]),a}(r.a.Component));$.contextType=x;var X=$,Y=w.a.query,K=(Y.Documents,Y.Map,Y.Ref,Y.Paginate,Y.Get,Y.Exists),Q=Y.Match,ee=(Y.Select,Y.Index),te=Y.Create,ae=(Y.Lambda,Y.Collection);Y.Join,Y.Call,Y.Function;function se(e,t){return console.log(e,t),this.test({name:"equalTo",exclusive:!1,message:t||"${path} must be the same as ${reference}",params:{reference:e.path},test:function(t){return t===this.resolve(e)}})}var re=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(j.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{username:"",email:"",disabled:!0,password:"",repeat_password:""},redir:!1,errors:{username:[],email:[],password:[],repeat_password:[]}},e.checkButtonDisability=function(){var t=e.state.data;delete t.disabled;var a=!1;(e.state.errors.username[0]||e.state.errors.email[0]||e.state.errors.password[0]||e.state.errors.repeat_password[0])&&(a=!0),e.schema.validate(e.state.data,{abortEarly:!0}).catch((function(e){a=!0})).then((function(){t.disabled=a,e.setState({data:t})}))},e.updateUsername=function(t){var a=Object(u.a)({},e.state.data),s=t.target.value;a.username=s,e.setState({data:a},e.validateUsername)},e.validateUsername=function(){var t=e.state.errors,a=e.state.data.username;t.username=[],e.schema.validateAt("username",{username:a},{abortEarly:!1,strict:!0}).catch((function(e){t.username=e.errors}));var s=new w.a.Client({secret:"fnAEaWbgzoAAwyZTDq94vnfSjZm27pfo9meEZH29",domain:"db.eu.fauna.com",scheme:"https"}),r=K(Q(ee("users_by_username"),a));s.query(r).then((function(a){a&&t.username.push("User with that username already exists"),e.setState({errors:t}),e.checkButtonDisability()}))},e.updateEmail=function(t){var a=Object(u.a)({},e.state.data),s=t.target.value;a.email=s,e.setState({data:a},e.validateEmail)},e.validateEmail=function(){var t=e.state.errors,a=e.state.data.email;t.email=[],e.schema.validateAt("email",{email:a},{abortEarly:!1,strict:!0}).catch((function(e){t.email=e.errors}));var s=new w.a.Client({secret:"fnAEaWbgzoAAwyZTDq94vnfSjZm27pfo9meEZH29",domain:"db.eu.fauna.com",scheme:"https"}),r=K(Q(ee("users_by_email"),a));s.query(r).then((function(a){a&&t.email.push("User with that email already exists"),e.setState({errors:t}),e.checkButtonDisability()}))},e.updatePassword=function(t){var a=Object(u.a)({},e.state.data),s=t.target.value,r=e.state.errors;r.password=[],a.password=s,e.schema.validateAt("password",{password:s},{abortEarly:!1,strict:!0}).catch((function(t){r.password=t.errors,e.setState({errors:r},e.checkButtonDisability)})),e.setState({data:a},e.checkButtonDisability)},e.updateRepeat=function(t){var a=Object(u.a)({},e.state.data),s=t.target.value,r=e.state.data.password,n=e.state.errors;n.repeat_password=[],a.repeat_password=s,e.schema.validateAt("repeat_password",{password:r,repeat_password:s},{abortEarly:!0,strict:!0}).catch((function(t){n.repeat_password=t.errors,e.setState({errors:n},e.checkButtonDisability)})),e.setState({data:a},e.checkButtonDisability)},e.mapErrors=function(e,t){return Object(p.jsx)("div",{className:"field-validation-error",role:"alert",children:e.map((function(e){return Object(p.jsx)("div",{children:e[0].toUpperCase()+e.slice(1)},e)}))})},e.formSubmit=function(t){t.preventDefault(),console.log("Hello");var a=e.state.data,s=a.username,r=a.password,n=a.email,c=new w.a.Client({secret:"fnAEaWbgzoAAwyZTDq94vnfSjZm27pfo9meEZH29",domain:"db.eu.fauna.com",scheme:"https"}),i=te(ae("users"),{credentials:{password:r},data:{username:s,email:n,picture:"https://cdn.pixabay.com/photo/2015/07/21/15/32/drawing-854034_960_720.png",posts:[]}});try{c.query(i).then((function(){i=Object(y.Login)(Q(ee("users_by_username"),s),{password:r}),c.query(i).then((function(t){var a=e.context;a.user;(0,a.setUser)(t.secret),localStorage.setItem("user",t.secret),e.setState({redir:!0})}))}))}catch(o){console.log(o)}},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){H.a(H.d,"equalTo",se),this.schema=H.b().shape({username:H.d().matches("^[a-zA-Z0-9_]*$","Username must only be the symbols A-Z and 0-9").min(3).max(30).required(),email:H.d().email().required(),password:H.d().matches("^[a-zA-Z0-9_]*$").min(8).max(30).required(),repeat_password:H.d().equalTo(H.c("password"))})}},{key:"render",value:function(){var e=this.state.redir;return Object(p.jsxs)("div",{id:"register_account",children:[e&&Object(p.jsx)(l.a,{replace:!0,to:"/"}),Object(p.jsx)("h1",{children:"Register An Account!"}),Object(p.jsxs)("form",{children:[Object(p.jsx)(E,{value:this.state.data.username,label:"Username",onChange:this.updateUsername}),Object(p.jsx)("br",{}),this.state.errors.username.length>0&&this.mapErrors(this.state.errors.username,"Username"),Object(p.jsx)("br",{}),Object(p.jsx)(E,{autoComplete:"off",value:this.state.data.email,label:"Email",onChange:this.updateEmail}),Object(p.jsx)("br",{}),this.state.errors.email.length>0&&this.mapErrors(this.state.errors.email,"Email"),Object(p.jsx)("br",{}),Object(p.jsx)(E,{type:"password",value:this.state.data.password,label:"Password",onChange:this.updatePassword}),Object(p.jsx)("br",{}),this.state.errors.password.length>0&&this.mapErrors(this.state.errors.password,"Password"),Object(p.jsx)("br",{}),Object(p.jsx)(E,{type:"password",value:this.state.data.repeat_password,label:"Repeat Password",onChange:this.updateRepeat}),Object(p.jsx)("br",{}),this.state.errors.repeat_password.length>0&&Object(p.jsx)("div",{className:"field-validation-error",role:"alert",children:"Passwords have to match"}),Object(p.jsx)("br",{}),Object(p.jsx)(v,{disabled:this.state.data.disabled,label:"Create the account",handleClick:this.formSubmit}),Object(p.jsx)("br",{}),Object(p.jsx)(o.b,{to:"/login",children:"Login"})]})]})}}]),a}(r.a.Component);re.contextType=x;var ne=re;var ce=function(){var e=Object(s.useContext)(x),t=(e.user,e.setUser),a=Object(l.g)();return Object(p.jsx)("div",{id:"logout",children:Object(p.jsx)(v,{handleClick:function(){t(),localStorage.clear(),a("/",{replace:!0})},label:"Logout"})})};var ie=function(){return Object(p.jsx)("div",{id:"about"})},oe=w.a.query,le=(oe.Documents,oe.Map),ue=oe.Ref,de=(oe.Paginate,oe.Get),je=(oe.Match,oe.CurrentIdentity),be=oe.Select,he=(oe.Index,oe.Create,oe.Lambda),me=oe.Collection,pe=(oe.Join,oe.Call,oe.Var);oe.Function;var fe=function(){var e=Object(l.g)(),t=Object(l.h)().userId,a=Object(s.useContext)(x),r=a.user,n=a.setUser,c=Object(s.useState)("Loading..."),o=Object(i.a)(c,2),u=o[0],d=o[1],j=Object(s.useState)(""),b=Object(i.a)(j,2),h=b[0],m=b[1],f=Object(s.useState)(""),O=Object(i.a)(f,2),v=O[0],g=O[1],y=Object(s.useState)(!0),C=Object(i.a)(y,2),S=C[0],E=C[1];return Object(s.useEffect)((function(){var a=new w.a.Client({secret:r,domain:"db.eu.fauna.com",scheme:"https"});if(console.log(t),r)a.query(be(["data"],de(t?ue(me("users"),t):je()))).then((function(e){d(e.username),m(e.picture),a.query(le(e.posts,he("X",de(pe("X"))))).then((function(e){g(e),console.log(e)}))})).catch((function(e){console.log(e),E(!1)}));else{var s=localStorage.getItem("user");if(s)n(s);else e("/",{replace:!0})}}),[r]),Object(p.jsx)("div",{id:"profile",children:S?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"profile-container",children:[Object(p.jsx)("div",{className:"picture",children:Object(p.jsx)("img",{src:h,alt:""})}),Object(p.jsx)("div",{className:"username",children:u})]}),Object(p.jsxs)("div",{id:"myposts",children:[Object(p.jsx)("h2",{children:"Posts"}),v?function(e){return console.log(e),e.length>0?e.map((function(e,t){return Object(p.jsxs)("div",{className:"post",children:[Object(p.jsx)("h3",{children:e.data.title}),Object(p.jsx)("img",{src:e.data.image}),Object(p.jsx)("div",{children:e.data.content})]},t)})):"No Posts Found!"}(v):"Loading..."]})]}):Object(p.jsx)("h1",{children:"Profile not found!"})})},Oe=w.a.query,ve=(Oe.Documents,Oe.Map,Oe.Ref,Oe.Paginate,Oe.Get),xe=Oe.Let,ge=Oe.Update,ye=Oe.Append,we=(Oe.Match,Oe.CurrentIdentity),Ce=Oe.Select,Se=(Oe.Index,Oe.Create),Ee=(Oe.Lambda,Oe.Collection),ke=(Oe.Join,Oe.Call,Oe.Var);Oe.Function;var Ae=function(){var e=Object(l.g)(),t=Object(s.useContext)(x),a=t.user,r=t.setUser,n=Object(s.useState)(""),c=Object(i.a)(n,2),o=c[0],u=c[1],d=Object(s.useState)(""),j=Object(i.a)(d,2),b=j[0],h=j[1],m=Object(s.useState)(""),f=Object(i.a)(m,2),O=f[0],g=f[1];return Object(s.useEffect)((function(){if(!a){var t=localStorage.getItem("user");if(t)r(t);else e("/",{replace:!0})}}),[a]),Object(p.jsxs)("div",{id:"create",children:[Object(p.jsx)("h1",{children:"Add posts here!"}),Object(p.jsxs)("form",{children:[Object(p.jsx)(E,{label:"Title",value:o,onChange:function(e){u(e.target.value)}}),Object(p.jsx)("br",{}),Object(p.jsx)(E,{label:"Image Source",value:b,onChange:function(e){h(e.target.value)}}),Object(p.jsx)("div",{className:"image-preview"}),Object(p.jsx)("img",{width:"200",src:b}),Object(p.jsx)("br",{}),Object(p.jsx)(E,{label:"Text",value:O,onChange:function(e){g(e.target.value)}}),Object(p.jsx)("br",{}),Object(p.jsx)(v,{label:"Create Post",handleClick:function(){console.log({title:o,image:b,text:O});var e=new w.a.Client({secret:a,domain:"db.eu.fauna.com",scheme:"https"});e.query(Se(Ee("posts"),{data:{owner:we(),title:o,image:b,content:O}})).then((function(t){e.query(xe({ref:we(),doc:ve(ke("ref")),array:Ce(["data","posts"],ke("doc"))},ge(ke("ref"),{data:{posts:ye([t.ref],ke("array"))}})))})),u(""),h(""),g("")}})]})]})};var _e=function(){var e=Object(s.useState)(null),t=Object(i.a)(e,2),a=t[0],r=t[1],n=Object(s.useMemo)((function(){return{user:a,setUser:r}}),[a,r]);return Object(p.jsx)(o.a,{children:Object(p.jsxs)(x.Provider,{value:n,children:[Object(p.jsx)(Z,{}),Object(p.jsxs)(l.d,{children:[Object(p.jsx)(l.b,{path:"/home",element:Object(p.jsx)(J,{})}),Object(p.jsx)(l.b,{path:"/about",element:Object(p.jsx)(ie,{})}),Object(p.jsx)(l.b,{exact:!0,path:"/profile",element:Object(p.jsx)(fe,{})}),Object(p.jsx)(l.b,{exact:!0,path:"/profile/:userId",element:Object(p.jsx)(fe,{})}),Object(p.jsx)(l.b,{path:"/create",element:Object(p.jsx)(Ae,{})}),Object(p.jsx)(l.b,{path:"/logout",element:Object(p.jsx)(ce,{})}),Object(p.jsx)(l.b,{path:"/login",element:Object(p.jsx)(X,{})}),Object(p.jsx)(l.b,{path:"/register",element:Object(p.jsx)(ne,{})}),Object(p.jsx)(l.b,{path:"/",exactly:!0,element:Object(p.jsx)(l.a,{to:"/home"})})]})]})})};c.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(_e,{})}),document.getElementById("root"))},63:function(e,t){},98:function(e,t,a){}},[[235,1,2]]]);
//# sourceMappingURL=main.8248504c.chunk.js.map